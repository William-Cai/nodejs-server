<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WebSocket</title>
</head>
<body>
<body>
<!--<button onclick="start()">启动</button>
<button onclick="stop()">停止</button>-->
<p>WebSocket</p>
<form role="form" id="chat_form" onsubmit="sendMessage(); return false;">
    <div class="form-group">
        <input class="form-control" type="text" name="message" id="message"
               placeholder="Type text to echo in here" value=""/>
    </div>
    <button type="button" id="send" class="btn btn-primary"
            onclick="sendMessage();">
        Send!
    </button>
</form>
<div id="console">

</div>
</body>
<script>
    var ws;
    function start() {
        ws = new WebSocket("ws://localhost:8080");
        ws.onopen = function (e) {
            console.log('Connection to server opened');
        };
        ws.onerror = function (e) {
            console.log("Connection error!");
        };
        ws.onclose = function (e) {
            console.log("Connection close!" +
                    " ws clean=" + e.wasClean +
                    " Code=" + e.code +
                    " Reason=" + e.reason);
        };
        ws.onmessage = function (e) {
            var data = JSON.parse(e.data);
            document.querySelector("#console").innerHTML += data + "<br/>";
        };
    }

    function stop() {
        ws.close();
    }

    //发送消息
    function sendMessage() {
        ws.send(document.getElementById('message').value);
    }

    //启动
    start()
</script>
</body>

</html>